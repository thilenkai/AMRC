College_no_outliers$Private_leveled <- ifelse(College_no_outliers$Private == "Yes", 1, -1)
table(College_no_outliers$Private, College_no_outliers$Private_leveled)
lm4 <- lm(Apps ~ Private_leveled, data = College_no_outliers)
summary(lm4)
set.seed(123)   # same randomness seed for reproducibility
n <- nrow(College_no_outliers)
train_index <- sample(1:n, size = 2/3 * n)
train <- College_no_outliers[train_index, ]
test <- College_no_outliers[-train_index, ]
lm5 <- lm(Apps ~ Private + Top10perc + Top25perc + F.Undergrad +
P.Undergrad + Outstate + Room.Board + Books + PhD +
Terminal + S.F.Ratio + perc.alumni + Expend + Grad.Rate,
data = train)
# summary(lm5)
par(mfrow = c(2, 2)) # arrange in a 2x2 grid
plot(lm5)
# pairs(College_no_outliers[, c("Apps", "F.Undergrad", "Expend", "Grad.Rate", "Outstate")]) # for pairwise relationship between vaiables - not asked here
lm5_scaled <- lm(Apps ~ scale(Top10perc) + scale(Top25perc) + scale(F.Undergrad) +
scale(P.Undergrad) + scale(Outstate) + scale(Room.Board) +
scale(Books) + scale(PhD) + scale(Terminal) +
scale(S.F.Ratio) + scale(perc.alumni) + scale(Expend) +
scale(Grad.Rate) + Private,
data = train)
lm5_scaled <- lm(Apps ~ scale(Top10perc) + scale(Top25perc) + scale(F.Undergrad) +
scale(P.Undergrad) + scale(Outstate) + scale(Room.Board) +
scale(Books) + scale(PhD) + scale(Terminal) +
scale(S.F.Ratio) + scale(perc.alumni) + scale(Expend) +
scale(Grad.Rate) + Private,
data = train)
summary(lm5_scaled)
lm5_scaled <- lm(Apps ~ scale(Top10perc) + scale(Top25perc) + scale(F.Undergrad) +
scale(P.Undergrad) + scale(Outstate) + scale(Room.Board) +
scale(Books) + scale(PhD) + scale(Terminal) +
scale(S.F.Ratio) + scale(perc.alumni) + scale(Expend) +
scale(Grad.Rate) + Private,
data = train)
summary(lm5_scaled)
knitr::opts_chunk$set(echo = TRUE)
data(College,package="ISLR")
str(College)
# Check for missing data
print(paste("Number of missing values:", sum(is.na(College))))
# linear regression based on those two only
lm1 <- lm(Outstate ~ Expend, data = College)
# Plot the data, and visualize the regression line
plot(College$Expend, College$Outstate,
xlab = "Expend ($ per student)",
ylab = "Outstate tuition ($)",
main = "Outstate vs Expend",
pch = 19, col = "blue")
abline(lm1, col = "red", lwd = 2)
# verifying outlier theory
boxplot(College$Expend,
main = "Boxplot of Expend",
ylab = "Expend ($ per student)")
# Calculate quartiles and IQR
Q1 <- quantile(College$Expend, 0.25)
Q3 <- quantile(College$Expend, 0.75)
IQR <- Q3 - Q1
# Keep all rows except extreme high outliers
College_no_outliers <- subset(College, Expend < (Q3 + 1.5 * IQR))
# calculate new model after removing upper outliers
lm2 <- lm(Outstate ~ Expend, data = College_no_outliers)
par(mfrow = c(1, 2))
# Original model
plot(College$Expend, College$Outstate,
main = "Original Data",
xlab = "Expend", ylab = "Outstate",
pch = 19, col = "gray")
abline(lm1, col = "red", lwd = 2)
# After removing high outliers
plot(College_no_outliers$Expend, College_no_outliers$Outstate,
main = "After Removing Upper Outliers",
xlab = "Expend", ylab = "Outstate",
pch = 19, col = "gray")
abline(lm2, col = "blue", lwd = 2)
par(mfrow = c(1, 1))
## Values copied in LateX table
# summary(lm1)$r.squared
# summary(lm2)$r.squared
# summary(lm1)$coefficients
# summary(lm2)$coefficients
lm3 <- lm(Apps ~ Private, data = College_no_outliers)
summary(lm3)
College_no_outliers$Private_leveled <- ifelse(College_no_outliers$Private == "Yes", 1, -1)
table(College_no_outliers$Private, College_no_outliers$Private_leveled)
lm4 <- lm(Apps ~ Private_leveled, data = College_no_outliers)
summary(lm4)
set.seed(123)   # same randomness seed for reproducibility
n <- nrow(College_no_outliers)
train_index <- sample(1:n, size = 2/3 * n)
train <- College_no_outliers[train_index, ]
test <- College_no_outliers[-train_index, ]
lm5 <- lm(Apps ~ Private + Top10perc + Top25perc + F.Undergrad +
P.Undergrad + Outstate + Room.Board + Books + PhD +
Terminal + S.F.Ratio + perc.alumni + Expend + Grad.Rate,
data = train)
# summary(lm5)
par(mfrow = c(2, 2)) # arrange in a 2x2 grid
plot(lm5)
# pairs(College_no_outliers[, c("Apps", "F.Undergrad", "Expend", "Grad.Rate", "Outstate")]) # for pairwise relationship between vaiables - not asked here
lm5_scaled <- lm(Apps ~ scale(Top10perc) + scale(Top25perc) + scale(F.Undergrad) +
scale(P.Undergrad) + scale(Outstate) + scale(Room.Board) +
scale(Books) + scale(PhD) + scale(Terminal) +
scale(S.F.Ratio) + scale(perc.alumni) + scale(Expend) +
scale(Grad.Rate) + Private,
data = train)
summary(lm5_scaled)
lm5_scaled <- lm(Apps ~ scale(Top10perc) + scale(Top25perc) + scale(F.Undergrad) +
scale(P.Undergrad) + scale(Outstate) + scale(Room.Board) +
scale(Books) + scale(PhD) + scale(Terminal) +
scale(S.F.Ratio) + scale(perc.alumni) + scale(Expend) +
scale(Grad.Rate) + Private,
data = train)
summary(lm5_scaled)
plot(lm5_scaled)
lm5_scaled <- lm(Apps ~ scale(Top10perc) + scale(Top25perc) + scale(F.Undergrad) +
scale(P.Undergrad) + scale(Outstate) + scale(Room.Board) +
scale(Books) + scale(PhD) + scale(Terminal) +
scale(S.F.Ratio) + scale(perc.alumni) + scale(Expend) +
scale(Grad.Rate) + Private,
data = train)
summary(lm5_scaled)
lm5_scaled <- lm(Apps ~ scale(Top10perc) + scale(Top25perc) + scale(F.Undergrad) +
scale(P.Undergrad) + scale(Outstate) + scale(Room.Board) +
scale(Books) + scale(PhD) + scale(Terminal) +
scale(S.F.Ratio) + scale(perc.alumni) + scale(Expend) +
scale(Grad.Rate) + Private,
data = train)
summary(lm5_scaled)
lm6 <- lm(Apps ~ scale(Top10perc) + scale(Top25perc) + scale(F.Undergrad) +
scale(P.Undergrad) + scale(Outstate) + scale(Room.Board) +
scale(Books) + scale(PhD) + scale(Terminal) +
scale(S.F.Ratio) + scale(perc.alumni) + scale(Expend) +
scale(Grad.Rate) + Private,
data = train)
summary(lm6)
# --- Predictions for lm5 (unscaled model) ---
pred_train_lm5 <- predict(lm5, newdata = train)
pred_test_lm5  <- predict(lm5, newdata = test)
# --- Compute RMSE for lm5 ---
rmse_train_lm5 <- sqrt(mean((train$Apps - pred_train_lm5)^2))
rmse_test_lm5  <- sqrt(mean((test$Apps - pred_test_lm5)^2))
# --- Predictions for lm6 (scaled model) ---
pred_train_lm6 <- predict(lm6, newdata = train)
pred_test_lm6  <- predict(lm6, newdata = test)
# --- Compute RMSE for lm6 ---
rmse_train_lm6 <- sqrt(mean((train$Apps - pred_train_lm6)^2))
rmse_test_lm6  <- sqrt(mean((test$Apps - pred_test_lm6)^2))
# --- Combine results into a table ---
rmse_results <- data.frame(
Model = c("lm5 (unscaled)", "lm6 (scaled)"),
RMSE_Train = c(rmse_train_lm5, rmse_train_lm6),
RMSE_Test  = c(rmse_test_lm5, rmse_test_lm6)
)
rmse_results
# --- assume train and test already created as in your code ---
# predictors to scale (numeric only)
num_vars <- c("Top10perc","Top25perc","F.Undergrad","P.Undergrad",
"Outstate","Room.Board","Books","PhD","Terminal",
"S.F.Ratio","perc.alumni","Expend","Grad.Rate")
# 1) compute centers and scales from training data
centers <- sapply(train[num_vars], mean, na.rm = TRUE)
sds     <- sapply(train[num_vars], sd,   na.rm = TRUE)
# helper to scale with training params (works columnwise)
scale_with_train <- function(df, centers, sds) {
df2 <- df
for (v in names(centers)) {
# avoid dividing by zero if sd = 0
if (sds[v] == 0) {
df2[[v]] <- df[[v]] - centers[v]
} else {
df2[[v]] <- (df[[v]] - centers[v]) / sds[v]
}
}
df2
}
# 2) create scaled train and test copies
train_scaled <- scale_with_train(train, centers, sds)
test_scaled  <- scale_with_train(test,  centers, sds)
# 3) fit models
# lm5: original (unscaled) trained on train
lm5 <- lm(Apps ~ Private + Top10perc + Top25perc + F.Undergrad +
P.Undergrad + Outstate + Room.Board + Books + PhD +
Terminal + S.F.Ratio + perc.alumni + Expend + Grad.Rate,
data = train)
# lm6: same formula but fit on the training data where numeric predictors are scaled
lm6 <- lm(Apps ~ Private + Top10perc + Top25perc + F.Undergrad +
P.Undergrad + Outstate + Room.Board + Books + PhD +
Terminal + S.F.Ratio + perc.alumni + Expend + Grad.Rate,
data = train_scaled)
# 4) predictions
# For lm5 (unscaled), predict using original train/test
pred_train_lm5 <- predict(lm5, newdata = train)
pred_test_lm5  <- predict(lm5, newdata = test)
# For lm6 (scaled), predict using scaled train/test
pred_train_lm6 <- predict(lm6, newdata = train_scaled)
pred_test_lm6  <- predict(lm6, newdata = test_scaled)
# 5) RMSE function and compute
rmse <- function(actual, predicted) sqrt(mean((actual - predicted)^2))
rmse_train_lm5 <- rmse(train$Apps, pred_train_lm5)
rmse_test_lm5  <- rmse(test$Apps,  pred_test_lm5)
rmse_train_lm6 <- rmse(train_scaled$Apps, pred_train_lm6) # Apps unchanged, but using same vector
rmse_test_lm6  <- rmse(test$Apps,  pred_test_lm6)         # compare predicted (from scaled predictors) to original Apps
# 6) results
data.frame(
Model = c("lm5 (unscaled)", "lm6 (scaled w/ train params)"),
RMSE_Train = c(rmse_train_lm5, rmse_train_lm6),
RMSE_Test  = c(rmse_test_lm5,  rmse_test_lm6)
)
# --- Predictions for lm5 (unscaled model) ---
pred_train_lm5 <- predict(lm5, newdata = train)
pred_test_lm5  <- predict(lm5, newdata = test)
# --- Compute RMSE for lm5 ---
rmse_train_lm5 <- sqrt(mean((train$Apps - pred_train_lm5)^2))
rmse_test_lm5  <- sqrt(mean((test$Apps - pred_test_lm5)^2))
# --- Predictions for lm6 (scaled model) ---
pred_train_lm6 <- predict(lm6, newdata = train)
pred_test_lm6  <- predict(lm6, newdata = test)
# --- Compute RMSE for lm6 ---
rmse_train_lm6 <- sqrt(mean((train$Apps - pred_train_lm6)^2))
rmse_test_lm6  <- sqrt(mean((test$Apps - pred_test_lm6)^2))
# --- Combine results into a table ---
rmse_results <- data.frame(
Model = c("lm5 (unscaled)", "lm6 (scaled)"),
RMSE_Train = c(rmse_train_lm5, rmse_train_lm6),
RMSE_Test  = c(rmse_test_lm5, rmse_test_lm6)
)
rmse_results
# --- Predictions for lm5 (unscaled model) ---
pred_train_lm5 <- predict(lm5, newdata = train)
pred_test_lm5  <- predict(lm5, newdata = test)
# --- Compute RMSE for lm5 ---
rmse_train_lm5 <- sqrt(mean((train$Apps - pred_train_lm5)^2))
rmse_test_lm5  <- sqrt(mean((test$Apps - pred_test_lm5)^2))
# --- Predictions for lm6 (scaled model) ---
pred_train_lm6 <- predict(lm6, newdata = train)
pred_test_lm6  <- predict(lm6, newdata = test)
# --- Compute RMSE for lm6 ---
rmse_train_lm6 <- sqrt(mean((train$Apps - pred_train_lm6)^2))
rmse_test_lm6  <- sqrt(mean((test$Apps - pred_test_lm6)^2))
# --- Combine results into a table ---
rmse_results <- data.frame(
Model = c("lm5 (unscaled)", "lm6 (scaled)"),
RMSE_Train = c(rmse_train_lm5, rmse_train_lm6),
RMSE_Test  = c(rmse_test_lm5, rmse_test_lm6)
)
rmse_results
# --- Predictions for lm5 (unscaled model) ---
pred_train_lm5 <- predict(lm5, newdata = train)
pred_test_lm5  <- predict(lm5, newdata = test)
# --- Compute RMSE for lm5 ---
rmse_train_lm5 <- sqrt(mean((train$Apps - pred_train_lm5)^2))
rmse_test_lm5  <- sqrt(mean((test$Apps - pred_test_lm5)^2))
# --- Predictions for lm6 (scaled model) ---
pred_train_lm6 <- predict(lm6, newdata = train)
pred_test_lm6  <- predict(lm6, newdata = test)
# --- Compute RMSE for lm6 ---
rmse_train_lm6 <- sqrt(mean((train$Apps - pred_train_lm6)^2))
rmse_test_lm6  <- sqrt(mean((test$Apps - pred_test_lm6)^2))
# --- Combine results into a table ---
rmse_results <- data.frame(
Model = c("lm5 (unscaled)", "lm6 (scaled)"),
RMSE_Train = c(rmse_train_lm5, rmse_train_lm6),
RMSE_Test  = c(rmse_test_lm5, rmse_test_lm6)
)
rmse_results
lm5_log <- lm(log(Apps) ~ Private + Top10perc + Top25perc + F.Undergrad +
P.Undergrad + Outstate + Room.Board + Books + PhD +
Terminal + S.F.Ratio + perc.alumni + Expend + Grad.Rate,
data = train)
par(mfrow = c(2, 2))
plot(lm5_log)
AIC(lm5, lm8)
lm8 <- lm(log(Apps) ~ Private + Top10perc + Top25perc + F.Undergrad +
P.Undergrad + Outstate + Room.Board + Books + PhD +
Terminal + S.F.Ratio + perc.alumni + Expend + Grad.Rate,
data = train)
par(mfrow = c(2, 2))
plot(lm8)
AIC(lm5, lm8)
knitr::opts_chunk$set(echo = TRUE)
data(College,package="ISLR")
str(College)
# Check for missing data
print(paste("Number of missing values:", sum(is.na(College))))
# linear regression based on those two only
lm1 <- lm(Outstate ~ Expend, data = College)
# Plot the data, and visualize the regression line
plot(College$Expend, College$Outstate,
xlab = "Expend ($ per student)",
ylab = "Outstate tuition ($)",
main = "Outstate vs Expend",
pch = 19, col = "blue")
abline(lm1, col = "red", lwd = 2)
# linear regression based on those two only
lm1 <- lm(Outstate ~ Expend, data = College)
# Plot the data, and visualize the regression line
plot(College$Expend, College$Outstate,
xlab = "Expend ($ per student)",
ylab = "Outstate tuition ($)",
main = "Outstate vs Expend",
pch = 19, col = "blue")
abline(lm1, col = "red", lwd = 2)
# linear regression based on those two only
lm1 <- lm(Outstate ~ Expend, data = College)
# Plot the data, and visualize the regression line
plot(College$Expend, College$Outstate,
xlab = "Expend ($ per student)",
ylab = "Outstate tuition ($)",
main = "Outstate vs Expend",
pch = 19, col = "blue")
abline(lm1, col = "red", lwd = 2)
# verifying outlier theory
boxplot(College$Expend,
main = "Boxplot of Expend",
ylab = "Expend ($ per student)")
# Calculate quartiles and IQR
Q1 <- quantile(College$Expend, 0.25)
Q3 <- quantile(College$Expend, 0.75)
IQR <- Q3 - Q1
# Keep all rows except extreme high outliers
College_no_outliers <- subset(College, Expend < (Q3 + 1.5 * IQR))
# calculate new model after removing upper outliers
lm2 <- lm(Outstate ~ Expend, data = College_no_outliers)
par(mfrow = c(1, 2))
# Original model
plot(College$Expend, College$Outstate,
main = "Original Data",
xlab = "Expend", ylab = "Outstate",
pch = 19, col = "gray")
abline(lm1, col = "red", lwd = 2)
# After removing high outliers
plot(College_no_outliers$Expend, College_no_outliers$Outstate,
main = "After Removing Upper Outliers",
xlab = "Expend", ylab = "Outstate",
pch = 19, col = "gray")
abline(lm2, col = "blue", lwd = 2)
par(mfrow = c(1, 1))
## Values copied in LateX table
# summary(lm1)$r.squared
# summary(lm2)$r.squared
# summary(lm1)$coefficients
# summary(lm2)$coefficients
lm3 <- lm(Apps ~ Private, data = College_no_outliers)
summary(lm3)
College_no_outliers$Private_leveled <- ifelse(College_no_outliers$Private == "Yes", 1, -1)
table(College_no_outliers$Private, College_no_outliers$Private_leveled)
lm4 <- lm(Apps ~ Private_leveled, data = College_no_outliers)
summary(lm4)
set.seed(123)   # same randomness seed for reproducibility
n <- nrow(College_no_outliers)
train_index <- sample(1:n, size = 2/3 * n)
train <- College_no_outliers[train_index, ]
test <- College_no_outliers[-train_index, ]
lm5 <- lm(Apps ~ Private + Top10perc + Top25perc + F.Undergrad +
P.Undergrad + Outstate + Room.Board + Books + PhD +
Terminal + S.F.Ratio + perc.alumni + Expend + Grad.Rate,
data = train)
# summary(lm5)
par(mfrow = c(2, 2)) # arrange in a 2x2 grid
plot(lm5)
# pairs(College_no_outliers[, c("Apps", "F.Undergrad", "Expend", "Grad.Rate", "Outstate")]) # for pairwise relationship between vaiables - not asked here
lm6 <- lm(Apps ~ scale(Top10perc) + scale(Top25perc) + scale(F.Undergrad) +
scale(P.Undergrad) + scale(Outstate) + scale(Room.Board) +
scale(Books) + scale(PhD) + scale(Terminal) +
scale(S.F.Ratio) + scale(perc.alumni) + scale(Expend) +
scale(Grad.Rate) + Private,
data = train)
summary(lm6)
# --- Predictions for lm5 (unscaled model) ---
pred_train_lm5 <- predict(lm5, newdata = train)
pred_test_lm5  <- predict(lm5, newdata = test)
# --- Compute RMSE for lm5 ---
rmse_train_lm5 <- sqrt(mean((train$Apps - pred_train_lm5)^2))
rmse_test_lm5  <- sqrt(mean((test$Apps - pred_test_lm5)^2))
# --- Predictions for lm6 (scaled model) ---
pred_train_lm6 <- predict(lm6, newdata = train)
pred_test_lm6  <- predict(lm6, newdata = test)
# --- Compute RMSE for lm6 ---
rmse_train_lm6 <- sqrt(mean((train$Apps - pred_train_lm6)^2))
rmse_test_lm6  <- sqrt(mean((test$Apps - pred_test_lm6)^2))
# --- Combine results into a table ---
rmse_results <- data.frame(
Model = c("lm5 (unscaled)", "lm6 (scaled)"),
RMSE_Train = c(rmse_train_lm5, rmse_train_lm6),
RMSE_Test  = c(rmse_test_lm5, rmse_test_lm6)
)
rmse_results
# --- Predictions for lm5 (unscaled model) ---
pred_train_lm5 <- predict(lm5, newdata = train)
pred_test_lm5  <- predict(lm5, newdata = test)
# --- Compute RMSE for lm5 ---
rmse_train_lm5 <- sqrt(mean((train$Apps - pred_train_lm5)^2))
rmse_test_lm5  <- sqrt(mean((test$Apps - pred_test_lm5)^2))
# --- Predictions for lm6 (scaled model) ---
pred_train_lm6 <- predict(lm6, newdata = train)
pred_test_lm6  <- predict(lm6, newdata = test)
# --- Compute RMSE for lm6 ---
rmse_train_lm6 <- sqrt(mean((train$Apps - pred_train_lm6)^2))
rmse_test_lm6  <- sqrt(mean((test$Apps - pred_test_lm6)^2))
# --- Combine results into a table ---
rmse_results <- data.frame(
Model = c("lm5 (unscaled)", "lm6 (scaled)"),
RMSE_Train = c(rmse_train_lm5, rmse_train_lm6),
RMSE_Test  = c(rmse_test_lm5, rmse_test_lm6)
)
rmse_results
lm8 <- lm(log(Apps) ~ Private + Top10perc + Top25perc + F.Undergrad +
P.Undergrad + Outstate + Room.Board + Books + PhD +
Terminal + S.F.Ratio + perc.alumni + Expend + Grad.Rate,
data = train)
par(mfrow = c(2, 2))
plot(lm8)
AIC(lm5, lm8)
knitr::opts_chunk$set(echo = TRUE)
data(College,package="ISLR")
str(College)
# Check for missing data
print(paste("Number of missing values:", sum(is.na(College))))
# linear regression based on those two only
lm1 <- lm(Outstate ~ Expend, data = College)
# Plot the data, and visualize the regression line
plot(College$Expend, College$Outstate,
xlab = "Expend ($ per student)",
ylab = "Outstate tuition ($)",
main = "Outstate vs Expend",
pch = 19, col = "blue")
abline(lm1, col = "red", lwd = 2)
# verifying outlier theory
boxplot(College$Expend,
main = "Boxplot of Expend",
ylab = "Expend ($ per student)")
# Calculate quartiles and IQR
Q1 <- quantile(College$Expend, 0.25)
Q3 <- quantile(College$Expend, 0.75)
IQR <- Q3 - Q1
# Keep all rows except extreme high outliers
College_no_outliers <- subset(College, Expend < (Q3 + 1.5 * IQR))
# calculate new model after removing upper outliers
lm2 <- lm(Outstate ~ Expend, data = College_no_outliers)
par(mfrow = c(1, 2))
# Original model
plot(College$Expend, College$Outstate,
main = "Original Data",
xlab = "Expend", ylab = "Outstate",
pch = 19, col = "gray")
abline(lm1, col = "red", lwd = 2)
# After removing high outliers
plot(College_no_outliers$Expend, College_no_outliers$Outstate,
main = "After Removing Upper Outliers",
xlab = "Expend", ylab = "Outstate",
pch = 19, col = "gray")
abline(lm2, col = "blue", lwd = 2)
par(mfrow = c(1, 1))
## Values copied in LateX table
# summary(lm1)$r.squared
# summary(lm2)$r.squared
# summary(lm1)$coefficients
# summary(lm2)$coefficients
lm3 <- lm(Apps ~ Private, data = College_no_outliers)
summary(lm3)
College_no_outliers$Private_leveled <- ifelse(College_no_outliers$Private == "Yes", 1, -1)
table(College_no_outliers$Private, College_no_outliers$Private_leveled)
lm4 <- lm(Apps ~ Private_leveled, data = College_no_outliers)
summary(lm4)
set.seed(123)   # same randomness seed for reproducibility
n <- nrow(College_no_outliers)
train_index <- sample(1:n, size = 2/3 * n)
train <- College_no_outliers[train_index, ]
test <- College_no_outliers[-train_index, ]
lm5 <- lm(Apps ~ Private + Top10perc + Top25perc + F.Undergrad +
P.Undergrad + Outstate + Room.Board + Books + PhD +
Terminal + S.F.Ratio + perc.alumni + Expend + Grad.Rate,
data = train)
# summary(lm5)
par(mfrow = c(2, 2)) # arrange in a 2x2 grid
plot(lm5)
# pairs(College_no_outliers[, c("Apps", "F.Undergrad", "Expend", "Grad.Rate", "Outstate")]) # for pairwise relationship between vaiables - not asked here
lm6 <- lm(Apps ~ scale(Top10perc) + scale(Top25perc) + scale(F.Undergrad) +
scale(P.Undergrad) + scale(Outstate) + scale(Room.Board) +
scale(Books) + scale(PhD) + scale(Terminal) +
scale(S.F.Ratio) + scale(perc.alumni) + scale(Expend) +
scale(Grad.Rate) + Private,
data = train)
summary(lm6)
# --- Predictions for lm5 (unscaled model) ---
pred_train_lm5 <- predict(lm5, newdata = train)
pred_test_lm5  <- predict(lm5, newdata = test)
# --- Compute RMSE for lm5 ---
rmse_train_lm5 <- sqrt(mean((train$Apps - pred_train_lm5)^2))
rmse_test_lm5  <- sqrt(mean((test$Apps - pred_test_lm5)^2))
# --- Predictions for lm6 (scaled model) ---
pred_train_lm6 <- predict(lm6, newdata = train)
pred_test_lm6  <- predict(lm6, newdata = test)
# --- Compute RMSE for lm6 ---
rmse_train_lm6 <- sqrt(mean((train$Apps - pred_train_lm6)^2))
rmse_test_lm6  <- sqrt(mean((test$Apps - pred_test_lm6)^2))
# --- Combine results into a table ---
rmse_results <- data.frame(
Model = c("lm5 (unscaled)", "lm6 (scaled)"),
RMSE_Train = c(rmse_train_lm5, rmse_train_lm6),
RMSE_Test  = c(rmse_test_lm5, rmse_test_lm6)
)
rmse_results
lm8 <- lm(log(Apps) ~ Private + Top10perc + Top25perc + F.Undergrad +
P.Undergrad + Outstate + Room.Board + Books + PhD +
Terminal + S.F.Ratio + perc.alumni + Expend + Grad.Rate,
data = train)
par(mfrow = c(2, 2))
plot(lm8)
AIC(lm5, lm8)
