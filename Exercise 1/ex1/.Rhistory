install.packages('tinytex')
install.packages("tinytex")
tinytex::install_tinytex()
getwd()
---
title: "Exercise 1"
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
## Load the necessary libraries
```{r}
install.packages("ISLR")
library(ISLR)
data(College,package="ISLR")
data
?College
str(College)
## Load and show data
```{r, echo=TRUE}
data(College,package="ISLR")
str(College)
in.na(College)
is.na(College)
# Check for missing data
print(paste("Number of missing values:", sum(is.na(College))))
## Load and show data
```{r, echo=TRUE}
## 1. Data Preparation
data(College,package="ISLR")
str(College)
# Check for missing data
print(paste("Number of missing values:", sum(is.na(College))))
str(College)
# Check for missing data
print(paste("Number of missing values:", sum(is.na(College))))
data(College,package="ISLR")
str(College)
# Check for missing data
print(paste("Number of missing values:", sum(is.na(College))))
# Check for missing data
print(paste("\n Number of missing values:", sum(is.na(College))))
data(College,package="ISLR")
str(College)
# Check for missing data
print(paste("\n Number of missing values:", sum(is.na(College))))
# Check for missing data
print(paste("\n Number of missing values:", sum(is.na(College))))
# Check for missing data
print(paste("\n \nNumber of missing values:", sum(is.na(College))))
# Check for missing data
print(paste("\n Number of missing values:", sum(is.na(College))))
# Check for missing data
print(paste("Number of missing values:", sum(is.na(College))))
data(College,package="ISLR")
str(College)
# Check for missing data
print(paste("Number of missing values:", sum(is.na(College))))
# Summary statistics of the number of applications
summary(College$Apps)
# Visualizing the distribution of Apps to check for skewness
hist(College$Apps,
main="Distribution of Apps",
xlab="Number of Applications",
breaks=30)
# linear regression based on those two only
lm1 <- lm(Outstate ~ Ecpend, data = College)
# linear regression based on those two only
lm1 <- lm(Outstate ~ Expend, data = College)
# Plot the data, and visualize the regression line
plot(College$Expend, College$Outstate,
xlab = "Expend ($ per student)",
ylab = "Outstate tuition ($)",
main = "Outstate vs Expend",
pch = 19, col = "blue")
# linear regression based on those two only
lm1 <- lm(Outstate ~ Expend, data = College)
# Plot the data, and visualize the regression line
plot(College$Expend, College$Outstate,
xlab = "Expend ($ per student)",
ylab = "Outstate tuition ($)",
main = "Outstate vs Expend",
pch = 19, col = "blue")
abline(lm1, col = "red", lwd = 2)
boxplot(College$Expend,
main = "Boxplot of Expend",
ylab = "Expend ($ per student)")
# verifying outlier theory
boxplot(College$Expend,
main = "Boxplot of Expend",
ylab = "Expend ($ per student)")
# verifying outlier theory
boxplot(College$Expend,
main = "Boxplot of Expend",
ylab = "Expend ($ per student)")
boxplot.stats(College$Expend)$out
# verifying outlier theory
boxplot(College$Expend,
main = "Boxplot of Expend",
ylab = "Expend ($ per student)")
# Calculate quartiles and IQR
Q1 <- quantile(College$Expend, 0.25)
Q3 <- quantile(College$Expend, 0.75)
IQR <- Q3 - Q1
# Keep all rows except extreme high outliers
College_no_outliers <- subset(College, Expend < (Q3 + 1.5 * IQR))
# calculate new model after removing upper outliers
lm2 <- lm(Outstate ~ Expend, data = College_no_outliers)
# Calculate quartiles and IQR
Q1 <- quantile(College$Expend, 0.25)
Q3 <- quantile(College$Expend, 0.75)
IQR <- Q3 - Q1
# Keep all rows except extreme high outliers
College_no_outliers <- subset(College, Expend < (Q3 + 1.5 * IQR))
# calculate new model after removing upper outliers
lm2 <- lm(Outstate ~ Expend, data = College_no_outliers)
par(mfrow = c(1, 2))
# Original model
plot(College$Expend, College$Outstate,
main = "Original Data",
xlab = "Expend", ylab = "Outstate",
pch = 19, col = "gray")
abline(lm1, col = "red", lwd = 2)
# After removing high outliers
plot(College_no_outliers$Expend, College_no_outliers$Outstate,
main = "After Removing Upper Outliers",
xlab = "Expend", ylab = "Outstate",
pch = 19, col = "gray")
abline(lm2, col = "blue", lwd = 2)
par(mfrow = c(1, 1))
# Calculate quartiles and IQR
Q1 <- quantile(College$Expend, 0.25)
Q3 <- quantile(College$Expend, 0.75)
IQR <- Q3 - Q1
# Keep all rows except extreme high outliers
College_no_outliers <- subset(College, Expend < (Q3 + 1.5 * IQR))
boxplot(College_no_outliers$Expend,
main = "Boxplot of Expend",
ylab = "Expend ($ per student)")
# calculate new model after removing upper outliers
lm2 <- lm(Outstate ~ Expend, data = College_no_outliers)
# Calculate quartiles and IQR
Q1 <- quantile(College$Expend, 0.25)
Q3 <- quantile(College$Expend, 0.75)
IQR <- Q3 - Q1
# Keep all rows except extreme high outliers
College_no_outliers <- subset(College, Expend < (Q3 + 1.5 * IQR))
# To check agian for outliers
'boxplot(College_no_outliers$Expend,
main = "Boxplot of Expend",
ylab = "Expend ($ per student)")'
# calculate new model after removing upper outliers
lm2 <- lm(Outstate ~ Expend, data = College_no_outliers)
# Calculate quartiles and IQR
Q1 <- quantile(College$Expend, 0.25)
Q3 <- quantile(College$Expend, 0.75)
IQR <- Q3 - Q1
# Keep all rows except extreme high outliers
College_no_outliers <- subset(College, Expend < (Q3 + 1.5 * IQR))
# calculate new model after removing upper outliers
lm2 <- lm(Outstate ~ Expend, data = College_no_outliers)
par(mfrow = c(1, 2))
# Original model
plot(College$Expend, College$Outstate,
main = "Original Data",
xlab = "Expend", ylab = "Outstate",
pch = 19, col = "gray")
abline(lm1, col = "red", lwd = 2)
# After removing high outliers
plot(College_no_outliers$Expend, College_no_outliers$Outstate,
main = "After Removing Upper Outliers",
xlab = "Expend", ylab = "Outstate",
pch = 19, col = "gray")
abline(lm2, col = "blue", lwd = 2)
par(mfrow = c(1, 1))
summary(lm1)$r.squared
summary(lm2)$r.squared
par(mfrow = c(1, 2))
# Original model
plot(College$Expend, College$Outstate,
main = "Original Data",
xlab = "Expend", ylab = "Outstate",
pch = 19, col = "gray")
abline(lm1, col = "red", lwd = 2)
# After removing high outliers
plot(College_no_outliers$Expend, College_no_outliers$Outstate,
main = "After Removing Upper Outliers",
xlab = "Expend", ylab = "Outstate",
pch = 19, col = "gray")
abline(lm2, col = "blue", lwd = 2)
par(mfrow = c(1, 1))
summary(lm1)$r.squared
summary(lm2)$r.squared
summary(lm1)$coefficients
summary(lm2)$coefficients
par(mfrow = c(1, 2))
# Original model
plot(College$Expend, College$Outstate,
main = "Original Data",
xlab = "Expend", ylab = "Outstate",
pch = 19, col = "gray")
abline(lm1, col = "red", lwd = 2)
# After removing high outliers
plot(College_no_outliers$Expend, College_no_outliers$Outstate,
main = "After Removing Upper Outliers",
xlab = "Expend", ylab = "Outstate",
pch = 19, col = "gray")
abline(lm2, col = "blue", lwd = 2)
par(mfrow = c(1, 1))
# Values copied in LateX table
'summary(lm1)$r.squared
summary(lm2)$r.squared
summary(lm1)$coefficients
summary(lm2)$coefficients'
par(mfrow = c(1, 2))
# Original model
plot(College$Expend, College$Outstate,
main = "Original Data",
xlab = "Expend", ylab = "Outstate",
pch = 19, col = "gray")
abline(lm1, col = "red", lwd = 2)
# After removing high outliers
plot(College_no_outliers$Expend, College_no_outliers$Outstate,
main = "After Removing Upper Outliers",
xlab = "Expend", ylab = "Outstate",
pch = 19, col = "gray")
abline(lm2, col = "blue", lwd = 2)
par(mfrow = c(1, 1))
## Values copied in LateX table
# summary(lm1)$r.squared
# summary(lm2)$r.squared
# summary(lm1)$coefficients
# summary(lm2)$coefficients
